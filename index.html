<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>¬øMe perdonas?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

<style>
*{
  box-sizing:border-box;
  font-family:'Nunito',sans-serif;
}

html, body{
  margin:0;
  padding:0;
  width:100vw;
  height:calc(var(--vh, 1vh) * 100);
  overflow:hidden;
  position:fixed;
  top:0;
  left:0;
  touch-action:none;
}

body{
  background:radial-gradient(circle at top,#1b1b2f,#0b0b14);
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
}

/* ---------- CONTENEDOR ---------- */
.container,
.final{
  text-align:center;
  z-index:5;
  padding:20px;
  max-width:100vw;
  max-height:100vh;
  overflow:hidden;
}

h1{
  font-size:clamp(2rem,6vw,3rem);
  margin-bottom:2rem;
}

.buttons{
  display:flex;
  gap:1.2rem;
  justify-content:center;
  flex-wrap:wrap;
}

button{
  padding:14px 30px;
  font-size:1.1rem;
  border-radius:40px;
  border:none;
  cursor:pointer;
  font-weight:900;
}

.yes{
  background:#ff4d6d;
  color:white;
}

.no{
  background:#2b2b2b;
  color:white;
}

/* ---------- NO INFINITO ---------- */
.tiny-no{
  position:absolute;
  padding:6px 10px;
  font-size:.7rem;
  border-radius:20px;
  background:#222;
  color:white;
  cursor:pointer;
}

/* ---------- CORAZONES FONDO ---------- */
.heart{
  position:absolute;
  width:22px;
  height:22px;
  transform:rotate(45deg);
  z-index:1;
}

.heart::before,
.heart::after{
  content:"";
  position:absolute;
  width:22px;
  height:22px;
  border-radius:50%;
  background:inherit;
}

.heart::before{left:-11px;}
.heart::after{top:-11px;}

/* ---------- INTRO CORAZONES ---------- */
.intro-heart{
  position:absolute;
  width:180px;
  height:180px;
  z-index:20;
}

/* ---------- MENSAJE FINAL ---------- */
.line{
  opacity:0;
  font-size:clamp(1.6rem,5vw,2.3rem);
  font-weight:900;
  color:#ff8fa3;
  margin-bottom:1rem;
}

.final img{
  margin-top:25px;
  width:180px;
  max-width:70%;
  opacity:0;
  border-radius:20px;
}
</style>
</head>

<body>

<div class="container" id="main">
  <h1>¬øMe perdonas?</h1>
  <div class="buttons">
    <button class="yes" onclick="sayYes()">S√≠</button>
    <button class="no" onclick="explode(this,1)">No</button>
  </div>
</div>

<audio id="music" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2bfc0a1a52.mp3">
</audio>

<script>
/* ---------- FIX VIEWPORT M√ìVIL ---------- */
function setVH(){
  document.documentElement.style.setProperty(
    '--vh',
    `${window.innerHeight * 0.01}px`
  );
}
setVH();
window.addEventListener('resize', setVH);

/* ---------- M√öSICA ---------- */
const music = document.getElementById("music");
music.volume = 0.45;
document.body.addEventListener("click",()=>{
  if(music.paused) music.play();
},{once:true});

/* ---------- VIBRACI√ìN ---------- */
const vibrate = ms => navigator.vibrate && navigator.vibrate(ms);

/* ---------- MENSAJE FINAL ---------- */
function sayYes(){
  vibrate([80,40,80]);
  document.body.innerHTML = `
    <div class="final">
      <div class="line">Much√≠simas gracias por perdonarme</div>
      <div class="line">amor de mi almaaaa üñ§üß°‚ù§Ô∏è</div>
      <div class="line">No volver√° a suceder</div>
      <img src="https://media.giphy.com/media/3oriO0OEd9QIDdllqo/giphy.gif" alt="gatito tierno">
    </div>
  `;

  const lines = document.querySelectorAll(".line");
  lines.forEach((l,i)=>{
    gsap.to(l,{
      opacity:1,
      delay:i*1.3,
      duration:1,
      onStart:()=>vibrate(20)
    });
  });

  gsap.to(".final img",{opacity:1,delay:4.5,duration:1.5});
}

/* ---------- NO INFINITO ---------- */
function explode(btn,level){
  vibrate(30);
  const r = btn.getBoundingClientRect();
  btn.remove();

  const pieces = Math.max(3,6-level);
  for(let i=0;i<pieces;i++){
    const n = document.createElement("div");
    n.className="tiny-no";
    n.innerText="No";
    n.style.left=r.left+"px";
    n.style.top=r.top+"px";
    n.style.transform=`scale(${Math.max(.25,1-level*.15)})`;
    n.onclick=()=>explode(n,level+1);
    document.body.appendChild(n);
    move(n);
  }
}

function move(el){
  gsap.to(el,{
    x:()=>Math.random()*innerWidth-innerWidth/2,
    y:()=>Math.random()*innerHeight-innerHeight/2,
    duration:3+Math.random()*2,
    repeat:-1,
    yoyo:true
  });
}

/* ---------- CORAZONES FONDO ---------- */
const colors=["#ff2f2f","#000","#ff8c1a"];

function bgHeart(){
  const h=document.createElement("div");
  h.className="heart";
  h.style.background=colors[Math.random()*3|0];
  h.style.left=Math.random()*innerWidth+"px";
  h.style.top=innerHeight+40+"px";
  document.body.appendChild(h);

  gsap.to(h,{
    y:-innerHeight-120,
    x:"+="+(Math.random()*200-100),
    duration:9,
    onComplete:()=>h.remove()
  });
}

/* ---------- LATIDO ---------- */
setInterval(()=>{
  gsap.fromTo(".heart",{scale:1},{scale:1.25,duration:.25,yoyo:true,repeat:1});
  vibrate(10);
},1200);

/* ---------- INTRO CORAZONES ---------- */
function introHeart(){
  const svg=document.createElementNS("http://www.w3.org/2000/svg","svg");
  svg.setAttribute("viewBox","0 0 32 29.6");
  svg.classList.add("intro-heart");
  svg.innerHTML=`<path fill="${colors[Math.random()*3|0]}"
    d="M23.6,0c-3.4,0-6.4,2.1-7.6,5.1C14.8,2.1,11.8,0,8.4,0
    C3.8,0,0,3.8,0,8.4c0,9.4,16,21.2,16,21.2s16-11.8,16-21.2
    C32,3.8,28.2,0,23.6,0z"/>`;

  svg.style.left=Math.random()*innerWidth+"px";
  svg.style.top=innerHeight+200+"px";
  document.body.appendChild(svg);

  gsap.to(svg,{
    y:-innerHeight-400,
    duration:4,
    ease:"power2.out",
    onComplete:()=>svg.remove()
  });
}

for(let i=0;i<40;i++){
  setTimeout(introHeart,i*80);
}

setInterval(bgHeart,500);
</script>

</body>
</html>
